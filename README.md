## Основные команды для запуска

Если терминал ругается, то использовать команду:

```bash
Set-ExecutionPolicy -Scope Process -ExecutionPolicy Bypass
```

1. Создание и активация виртуального окружения:
```bash
python -m venv venv
```
```bash
.\venv\Scripts\activate  # для Windows
```
```bash
source venv/bin/activate # для Linux/Mac
```

2. Установка зависимостей с помощью импорта файла:
```bash
pip install -r requirements.txt
```

3. Инициализация базы данных:
```bash
python init_db.py
```

4. Запуск самого приложения:
```bash
python -m app.main
```

Сервер запустится по следующему адресу `http://127.0.0.1:8000`, так как когда запускал `http://0.0.0.0:8000`, то ничего не работало.

## Проверка работы docker
1. Построить образ:
```bash
docker compose build
```
docker compose build
2. Запустить сервисы:
```bash
docker compose up
```
docker compose up
3. Построить образ и запустить сервисы:
```bash
docker compose up --build
```
## Проверка работы БД
Для проверки работы БД были созданы файлы:
check_db.py
```bash
python check_db.py
```
Если после запуска выводится только колонка users, то нужно выполнить:
```bash
python create_tables.py
```
После этого БД заполнится всеми нужными колонками Tables: ['addresses', 'order_products', 'orders', 'products', 'users']
## Проверка RabbitMQ
Следующие команды лучше выполнять в отдельных терминалах.
Перед этим также нужно запустить БД и докер как описано выше.
Используется команда для запуска файла rabbitMQ.py:
```bash
python rabbitMQ.py
```
```bash
Далее необходимо запустить файл продюсера данных:
python -m scripts.producer
```
По адресу `http://localhost:15672` будет работать UI в котором можно будет проверить работу RabbitMQ. По умолчанию логин и пароль guest/guest.
## Проверка работы тестов

В папке `tests` находятся тесты.
Примеры вызовов этих тестов приведены ниже ниже.

1. `get_operations.py` - примеры получения данных:
   - Получение списка всех пользователей
   - Получение конкретного пользователя по ID
   ```bash
   python crud_examples/get_operations.py
   ```

2. `post_operations.py` - примеры создания новых пользователей:
   - Создание нового пользователя
   - Обработка ошибок при дублировании данных
   ```bash
   python crud_examples/post_operations.py
   ```

3. `put_operations.py` - примеры обновления данных:
   - Полное обновление пользователя
   - Частичное обновление отдельных полей
   ```bash
   python crud_examples/put_operations.py
   ```

4. `delete_operations.py` - примеры удаления данных:
   - Удаление пользователя
   - Проверка успешного удаления
   ```bash
   python crud_examples/delete_operations.py
   ```

Каждый файл содержит подробные комментарии и примеры использования. 
Перед запуском примеров необходимо проверить, что:
1. Сервер запущен (`python -m app.main`)
2. База данных инициализирована (`python init_db.py`)
3. Установлен пакет requests (`pip install requests`)

## API Endpoints (Конечные точки API)

API Endpoints - это URL-адреса, по которым можно выполнять различные операции с данными. В нашем приложении доступны следующие endpoints.

### 1. Получение списка пользователей
- Метод: `GET`
- URL: `http://127.0.0.1:8000/users`
- Описание: Возвращает список всех пользователей
- Как использовать: Просто откройте URL в браузере или выполните GET-запрос

### 2. Получение конкретного пользователя
- Метод: `GET`
- URL: `http://127.0.0.1:8000/users/{user_id}`
- Описание: Возвращает информацию о пользователе по его ID
- Пример: `http://127.0.0.1:8000/users/1` - получить пользователя с ID=1

### 3. Создание нового пользователя
- Метод: `POST`
- URL: `http://127.0.0.1:8000/users`
- Тело запроса (пример):
```json
{
    "username": "Loken_X",
    "email": "Loken_X_Istvaan_III@example.com",
    "first_name": "Локен",
    "last_name": "Хорусович"
}
```
- Как использовать: Отправьте POST-запрос с JSON-данными (можно использовать Postman или curl)

### 4. Обновление пользователя
- Метод: `PUT`
- URL: `http://127.0.0.1:8000/users/{user_id}`
- Тело запроса (пример):
```json
{
    "first_name": "Церберус",
    "last_name": "Нехорусович"
}
```
- Примечание: Все поля опциональны, можно обновить только нужные поля

### 5. Удаление пользователя
- Метод: `DELETE`
- URL: `http://127.0.0.1:8000/users/{user_id}`
- Описание: Удаляет пользователя с указанным ID
- Как использовать: Отправьте DELETE-запрос на URL с ID пользователя
## Модели данных

### User (Пользователь)
- `id` - уникальный идентификатор
- `username` - имя пользователя (уникальное)
- `email` - email (уникальный)
- `first_name` - имя
- `last_name` - фамилия

### Product (Продукт)
- `id` - уникальный идентификатор
- `title` - название продукта
- `price_cents` - цена в центах
- `stock_quantity` - количество на складе

### Order (Заказ)
- `id` - уникальный идентификатор
- `user_id` - ID пользователя
- `shipping_address_id` - ID адреса доставки
- `created_at` - дата создания
- `products` - список продуктов в заказе (many-to-many)
```
